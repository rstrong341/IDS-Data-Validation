Sub ValidateCells()
   Dim ws As Worksheet
   Set ws = ThisWorkbook.Sheets("Item Data Sheet") ' Selecting the Sheet being used
   ' Selecting the cells being highlighted red if they are required fields
   Dim rng As Range
   Set rng = ws.Range("D7, D8, D9, D10, D11, D31, D33, D45:D50, H45, E21:E25, K16, K17, K29, K30, D28, C35, C36, D35, D36, D37")
   Dim cell As Range
   For Each cell In rng
       If cell.Value = "" Then
           cell.Interior.Color = RGB(255, 200, 200) ' If blank then highlight red
       Else
           ' If not blank, highlight green
           cell.Interior.ThemeColor = xlThemeColorAccent3
           cell.Interior.TintAndShade = 0.6
       End If
   Next cell
   ' Check condition: That Case Layers * Tie = Units Per Pallet
   If ws.Range("D37").Value <> "" And ws.Range("C36").Value <> "" And ws.Range("C35").Value <> "" Then
       If ws.Range("D37").Value * ws.Range("C36").Value <> ws.Range("C35").Value Then
           ws.Range("D37, C36, C35").Interior.Color = RGB(255, 255, 0) ' If incorrect highlight Yellow
           ws.Range("M11").Value = "Pallet Hi layers (Case Count) x Units per Pallet Tie (Primary UOM) = Units per Pallet (Primary UOM)"
   Else
       ws.Range("M11").ClearContents ' Clear the message if no error is present
       End If
   End If
   ' Check condition: That Units Per Pallet Divided by Primary Units Per Case = Units Per Pallet Case count
   If ws.Range("C35").Value <> "" And ws.Range("D31").Value <> "" And ws.Range("D35").Value <> "" Then
       If ws.Range("C35").Value / ws.Range("D31").Value <> ws.Range("D35").Value Then
           ws.Range("C35, D31, D35").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
           ws.Range("M12").Value = "Units per Pallet (Primary UOM) / Primary Units per Case = Units per Pallet (Case Count)"
   Else
       ws.Range("M12").ClearContents ' Clear the message if no error is present
       End If
   End If
   ' Check condition: That Pallet Layers * Units per Pallet Tie = Total Units
   If ws.Range("D37").Value <> "" And ws.Range("D36").Value <> "" And ws.Range("D35").Value <> "" Then
       If ws.Range("D37").Value * ws.Range("D36").Value <> ws.Range("D35").Value Then
           ws.Range("D37, D36, D35").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
           ws.Range("M13").Value = "Units per Pallet (Case Count) / Units per Pallet Tie (Case Count) = Pallet Hi layers (Case Count)"
   Else
       ws.Range("M13").ClearContents ' Clear the message if no error is present
       End If
   End If
   
    ' If "Floor Loaded" is selected, then provide the same checks for the pallet conversions
   If ws.Range("D33").Value = "Floor Loaded" Then
       ' Check condition: That Units Per Pallet / Primary Units Per Case = Units Per Pallet Case count
       If ws.Range("C40").Value / ws.Range("D31").Value <> ws.Range("D40").Value Then
           Union(ws.Range("C40"), ws.Range("D31"), ws.Range("D40")).Interior.Color = RGB(255, 255, 0)
           ws.Range("M12").Value = "Units per Pallet (Primary UOM) / Primary Units per Case = Units per Pallet (Case Count)"
       Else
           ws.Range("M12").ClearContents
       End If
       ' Check condition: That Pallet Layers * Units per Pallet Tie = Total Units
       If ws.Range("D42").Value * ws.Range("C41").Value <> ws.Range("C40").Value Then
           Union(ws.Range("D42"), ws.Range("C41"), ws.Range("C40")).Interior.Color = RGB(255, 255, 0)
           ws.Range("M11").Value = "Pallet Hi layers (Case Count) x Units per Pallet Tie (Primary UOM) = Units per Pallet (Primary UOM)"
       Else
           ws.Range("M11").ClearContents
       End If
       ' Check condition: That Case Layers * Tie = Units Per Palle
       If ws.Range("D42").Value * ws.Range("D41").Value <> ws.Range("D40").Value Then
           Union(ws.Range("D42"), ws.Range("D41"), ws.Range("D40")).Interior.Color = RGB(255, 255, 0)
           ws.Range("M13").Value = "Units per Pallet (Case Count) / Units per Pallet Tie (Case Count) = Pallet Hi layers (Case Count)"
       Else
           ws.Range("M13").ClearContents
       End If
   End If
   
   
   ' Check for metric/imperial mix
   Dim unit1 As String, unit2 As String
   unit1 = UCase(ws.Range("K29").Value)
   unit2 = UCase(ws.Range("K30").Value)
   If (unit1 = "IN" And unit2 = "KG") Or (unit1 = "CM" And unit2 = "LB") Then
       ws.Range("K29, K30").Interior.Color = RGB(255, 255, 0) ' Yellow highlight for mismatched units
       ws.Range("M9").Value = "Please don’t mix imperial and metric measurements"
   Else
       ws.Range("M9").ClearContents ' Clear the message if no error is present
   End If
   ' Check for 14-digit length in GTIN section
   Dim hCell As Range
   For Each hCell In ws.Range("H22:H25")
       If hCell.Value <> "" Then
           If Len(hCell.Value) = 14 Then
               ' If GTIN is 14 digits, then highlight green
               hCell.Interior.ThemeColor = xlThemeColorAccent3
               hCell.Interior.TintAndShade = 0.6
           Else
               ' If it is not 14 digits, highlight yellow
               hCell.Interior.Color = RGB(255, 255, 0)
               ws.Range("M10").Value = "Please make sure GTINS have Exactly 14 Digits including Leading and Trailing Zeros"
           End If
       End If
   Next hCell
   ' Check that net weight isn't greater than gross weight
   Dim netWeight As Double, grossWeight As Double
   Dim columnsToCheck As Variant
   Dim col As Variant
   columnsToCheck = Array("H", "I", "J", "K")
   For Each col In columnsToCheck
       ' Verify both cells are numeric before proceeding
       If IsNumeric(ws.Range(col & "36").Value) And IsNumeric(ws.Range(col & "37").Value) Then
           netWeight = ws.Range(col & "36").Value
           grossWeight = ws.Range(col & "37").Value
           If netWeight > grossWeight Then
               ws.Range(col & "36," & col & "37").Interior.Color = RGB(255, 255, 0) ' Highlight yellow if incorrect
               ws.Range("M14").Value = "Please makes sure Gross Weight is greater than Net Weight"
           ElseIf grossWeight >= netWeight Then
               ws.Range(col & "36," & col & "37").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range(col & "36," & col & "37").Interior.TintAndShade = 0.6 ' If correct, highlight green
               ws.Range("M14").ClearContents ' Clear the message if no error is present
           End If
       End If
   Next col
    ' Check to make sure Pallet Length is within parameters
   If IsNumeric(ws.Range("K33").Value) Then
       If unit1 = "CM" Then
           If ws.Range("K33").Value > 101 Then
               ws.Range("K33").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
               ws.Range("M15").Value = "Please make sure Pallet Length is no greater than 101 cm"
           Else
               ws.Range("K33").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range("K33").Interior.TintAndShade = 0.6 ' Green highlight
               ws.Range("M15").ClearContents
           End If
       Else ' Check for IN
           If ws.Range("K33").Value > 40 Then
               ws.Range("K33").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
               ws.Range("M15").Value = "Please make sure Pallet Length is no greater than 40 inches"
           Else
               ws.Range("K33").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range("K33").Interior.TintAndShade = 0.6 ' Green highlight
               ws.Range("M15").ClearContents
           End If
       End If
   End If
   ' Check to make sure Pallet Width is within parameters
   If IsNumeric(ws.Range("K34").Value) Then
       If unit1 = "CM" Then
           If ws.Range("K34").Value > 121 Then
               ws.Range("K34").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
               ws.Range("M16").Value = "Please make sure Pallet Width is no greater than 121 cm"
           Else
               ws.Range("K34").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range("K34").Interior.TintAndShade = 0.6 ' Green highlight
               ws.Range("M16").ClearContents
           End If
       Else ' Check for IN
           If ws.Range("K34").Value > 48 Then
               ws.Range("K34").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
               ws.Range("M16").Value = "Please make sure Pallet Width is no greater than 48 inches"
           Else
               ws.Range("K34").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range("K34").Interior.TintAndShade = 0.6 ' Green highlight
               ws.Range("M16").ClearContents
           End If
       End If
   End If
   
      ' Set case PUOM PUPC to 1
   If Range("D28").Value = "CS" Then
       Range("D31").Value = 1
       ' Sync C40 and D40
       Dim cVal35 As Variant, dVal35 As Variant
       cVal35 = Range("C35").Value
       dVal35 = Range("D35").Value
       If IsEmpty(cVal35) And Not IsEmpty(dVal35) Then
           Range("C35").Value = dVal35
       ElseIf Not IsEmpty(cVal35) And IsEmpty(dVal35) Then
           Range("D35").Value = cVal35
       ElseIf cVal35 <> dVal35 Then
           Range("D35").Value = cVal35
       End If
       ' Sync C41 and D41
       Dim cVal36 As Variant, dVal36 As Variant
       cVal36 = Range("C36").Value
       dVal36 = Range("D36").Value
       If IsEmpty(cVal36) And Not IsEmpty(dVal36) Then
           Range("C36").Value = dVal36
       ElseIf Not IsEmpty(cVal36) And IsEmpty(dVal36) Then
           Range("D36").Value = cVal36
       ElseIf cVal36 <> dVal36 Then
           Range("D36").Value = cVal36
       End If
   End If
   
   
   
   ' Check to make sure Pallet Height is within parameters
   If IsNumeric(ws.Range("K35").Value) Then
       If unit1 = "CM" Then
           If ws.Range("K35").Value > 134 Then
               ws.Range("K35").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
               ws.Range("M17").Value = "Please make sure Pallet Height is no greater than 134 cm"
           Else
               ws.Range("K35").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range("K35").Interior.TintAndShade = 0.6 ' Green highlight
               ws.Range("M17").ClearContents
           End If
       Else ' Check for IN
           If ws.Range("K35").Value > 53 Then
               ws.Range("K35").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
               ws.Range("M17").Value = "Please make sure Pallet Height is no greater than 53 inches"
           Else
               ws.Range("K35").Interior.ThemeColor = xlThemeColorAccent3
               ws.Range("K35").Interior.TintAndShade = 0.6 ' Green highlight
               ws.Range("M17").ClearContents
           End If
       End If
   End If
      ' Check to make sure Case/Net Weight doesn't exceed Maximum Restrictions
If IsNumeric(ws.Range("J36").Value) Then
   If ws.Range("K29").Value = "CM" Then
       If ws.Range("J36").Value > 177 Then
           ws.Range("J36").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
           ws.Range("M18").Value = "Case net weight can’t be greater than 177 KG."
       Else
           ws.Range("M18").ClearContents
       End If
   Else ' Check for IN
       If ws.Range("J36").Value > 70 Then
           ws.Range("J36").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
           ws.Range("M18").Value = "Case net weight can’t be greater than 70 LB."
       Else
           ws.Range("M18").ClearContents
       End If
   End If
End If
If IsNumeric(ws.Range("J37").Value) Then
   If ws.Range("K29").Value = "CM" Then
       If ws.Range("J37").Value > 177 Then
           ws.Range("J37").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
           ws.Range("M19").Value = "Case Gross weight can’t be greater than 177 KG."
       Else
           ws.Range("M19").ClearContents
       End If
Else ' Check for IN
       If ws.Range("J37").Value > 70 Then
           ws.Range("J37").Interior.Color = RGB(255, 255, 0) ' Yellow highlight
           ws.Range("M19").Value = "Case Net Weight can’t be greater than 70 LB."
       Else
           ws.Range("M19").ClearContents
       End If
   End If
End If
End Sub
